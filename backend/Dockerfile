# Базовый слой для нового образа
# Конкретно этот слой пдк в контейнере ос линух (дебиан)
# и предустановленный интерпретатор питона 3.12
FROM python:3.9

# В образе переходим в директорию /апп (если нет, то создастся)
WORKDIR /app

RUN pip install gunicorn==23.0.0
# Скопировать с локал компа файл зависимостей в текущую дир-ю
COPY requirements.txt .

# Инструкция RUN вызывает ту утилиту, которая уже установлена в образе
# --no-cache=dir позволяет не сохранять в служебной директории копии пакетов
# так как это лишний груз
RUN pip install -r requirements.txt --no-cache-dir

# Скопировать все содержимое локал дир-ии в текущую дир-ю образа /апп
COPY . .

# Инструкция CMD указывает какую команду выполнить при запуске контейнера
# В докерфайле срабатывает только одна CMD (самая последняя)
CMD ["gunicorn", "--bind", "0.0.0.0:8000", "backend.wsgi"]